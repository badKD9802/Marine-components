<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>영마린테크 관리자</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/admin.css">
    <!-- Markdown 렌더링 라이브러리 -->
    <script src="https://cdn.jsdelivr.net/npm/marked@11.1.1/marked.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/dompurify@3.0.8/dist/purify.min.js"></script>
</head>
<body>
    <!-- ===== 로그인 ===== -->
    <div id="loginView" class="login-container">
        <div class="login-box">
            <h1>Young Marine Tech</h1>
            <p>관리자 로그인</p>
            <input type="password" id="passwordInput" placeholder="비밀번호를 입력하세요" />
            <div class="error" id="loginError"></div>
            <button class="btn btn-accent" style="width:100%" onclick="handleLogin()">로그인</button>
        </div>
    </div>

    <!-- ===== 대시보드 ===== -->
    <div id="dashboardView" class="dashboard">
        <div class="header">
            <h1>Young Marine Tech 관리자</h1>
            <div style="display:flex;gap:10px;align-items:center;">
                <button onclick="toggleDarkMode()" style="background:var(--bg-gray);border:1px solid var(--border);padding:8px 12px;border-radius:6px;cursor:pointer;font-size:1.2rem;" title="다크 모드 전환">🌓</button>
                <button class="logout-btn" onclick="handleLogout()">로그아웃</button>
            </div>
        </div>

        <div class="tab-nav">
            <!-- 운영 관리 -->
            <button class="active" onclick="switchTab('guide')">📊 대시보드</button>
            <button onclick="switchTab('products')">📦 상품</button>
            <button onclick="switchTab('inquiry')">📋 견적문의</button>
            <span class="tab-divider"></span>
            <!-- AI 기능 -->
            <button onclick="switchTab('mail')">✉️ 메일</button>
            <button onclick="switchTab('rag')">💬 Q&A</button>
            <button onclick="switchTab('docs')">📁 문서</button>
            <span class="tab-divider"></span>
            <!-- 시스템 -->
            <button onclick="switchTab('homepage')">🏠 설정</button>
            <button onclick="switchTab('logs')">📝 로그</button>
        </div>

        <!-- ===== 대시보드 탭 ===== -->
        <div id="tabGuide" class="tab-content active">
            <div class="guide-container">
                <div class="guide-hero">
                    <div class="hero-icon">&#128200;</div>
                    <h2>대시보드</h2>
                    <p>시스템 현황을 한눈에 확인하세요</p>
                </div>

                <!-- 통계 위젯 -->
                <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:16px;margin-bottom:30px;">
                    <!-- 메일 작성 -->
                    <div style="background:var(--bg-white);border:1px solid var(--border);padding:20px;border-radius:8px;">
                        <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:12px;">
                            <span style="font-size:0.8rem;color:var(--text-muted);font-weight:500;">메일 작성</span>
                            <span style="font-size:1.2rem;opacity:0.6;">📧</span>
                        </div>
                        <div style="font-size:2rem;font-weight:700;color:var(--text-dark);margin-bottom:6px;" id="statMailTotal">-</div>
                        <div style="font-size:0.75rem;color:var(--text-light);">오늘 <span id="statMailToday" style="font-weight:600;color:var(--text-regular)">-</span> · 이번 주 <span id="statMailWeek" style="font-weight:600;color:var(--text-regular)">-</span></div>
                    </div>
                    <!-- 문서 관리 -->
                    <div style="background:var(--bg-white);border:1px solid var(--border);padding:20px;border-radius:8px;">
                        <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:12px;">
                            <span style="font-size:0.8rem;color:var(--text-muted);font-weight:500;">문서 관리</span>
                            <span style="font-size:1.2rem;opacity:0.6;">📁</span>
                        </div>
                        <div style="font-size:2rem;font-weight:700;color:var(--text-dark);margin-bottom:6px;" id="statDocTotal">-</div>
                        <div style="font-size:0.75rem;color:var(--text-light);">컨설턴트 <span id="statDocConsultant" style="font-weight:600;color:var(--text-regular)">-</span> · RAG <span id="statDocRag" style="font-weight:600;color:var(--text-regular)">-</span></div>
                    </div>
                    <!-- RAG 대화 -->
                    <div style="background:var(--bg-white);border:1px solid var(--border);padding:20px;border-radius:8px;">
                        <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:12px;">
                            <span style="font-size:0.8rem;color:var(--text-muted);font-weight:500;">RAG 대화</span>
                            <span style="font-size:1.2rem;opacity:0.6;">💬</span>
                        </div>
                        <div style="font-size:2rem;font-weight:700;color:var(--text-dark);margin-bottom:6px;" id="statConvTotal">-</div>
                        <div style="font-size:0.75rem;color:var(--text-light);">오늘 <span id="statConvToday" style="font-weight:600;color:var(--text-regular)">-</span></div>
                    </div>
                    <!-- 견적문의 -->
                    <div style="background:var(--bg-white);border:1px solid var(--border);padding:20px;border-radius:8px;">
                        <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:12px;">
                            <span style="font-size:0.8rem;color:var(--text-muted);font-weight:500;">견적문의</span>
                            <span style="font-size:1.2rem;opacity:0.6;">📋</span>
                        </div>
                        <div style="font-size:2rem;font-weight:700;color:var(--text-dark);margin-bottom:6px;" id="statInqTotal">-</div>
                        <div style="font-size:0.75rem;color:var(--text-light);">오늘 <span id="statInqToday" style="font-weight:600;color:var(--text-regular)">-</span></div>
                    </div>
                </div>

                <div class="guide-cards">
                    <div class="guide-card" onclick="switchTab('rag')">
                        <div class="card-icon">&#128172;</div>
                        <div class="card-title">문서 내 Q&A</div>
                        <div class="card-desc">업로드된 문서 기반<br>문서 내 Q&A</div>
                        <span class="card-link">바로가기 &rarr;</span>
                    </div>
                    <div class="guide-card" onclick="switchTab('mail')">
                        <div class="card-icon">&#9993;</div>
                        <div class="card-title">메일 작성</div>
                        <div class="card-desc">수신 메일 AI 분석 &rarr;<br>자동 답장 생성 · 발송</div>
                        <span class="card-link">바로가기 &rarr;</span>
                    </div>
                    <div class="guide-card" onclick="switchTab('inquiry')">
                        <div class="card-icon">&#128221;</div>
                        <div class="card-title">견적문의</div>
                        <div class="card-desc">고객 견적문의<br>확인 · 답변 관리</div>
                        <span class="card-link">바로가기 &rarr;</span>
                    </div>
                    <div class="guide-card" onclick="switchTab('docs')">
                        <div class="card-icon">&#128218;</div>
                        <div class="card-title">문서 관리</div>
                        <div class="card-desc">PDF/이미지 업로드 후<br>AI가 자동 분석 · 색인</div>
                        <span class="card-link">바로가기 &rarr;</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- ===== 상품 관리 탭 ===== -->
        <div id="tabProducts" class="tab-content">
            <div class="tab-header">
                <h2>📦 상품 관리</h2>
                <div style="display:flex;gap:10px;align-items:center;">
                    <input type="text" id="productSearchInput" placeholder="상품명, 부품번호 검색..." style="padding:8px 12px;border:1px solid var(--border);border-radius:6px;width:250px;">
                    <select id="productCategoryFilter" onchange="loadProducts()" style="padding:8px 12px;border:1px solid var(--border);border-radius:6px;">
                        <option value="">전체 카테고리</option>
                    </select>
                    <button class="btn btn-ghost" onclick="toggleCategoryManage()">🏷️ 카테고리 관리</button>
                    <button class="btn btn-primary" onclick="showProductForm()">➕ 상품 추가</button>
                </div>
            </div>

            <!-- 카테고리 관리 패널 -->
            <div id="categoryManagePanel" style="display:none;background:var(--bg-gray);padding:20px;margin:0 20px 20px;border-radius:8px;">
                <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:16px;">
                    <h3 style="margin:0;font-size:1rem;">카테고리 관리</h3>
                    <button class="btn btn-ghost btn-sm" onclick="toggleCategoryManage()">닫기</button>
                </div>
                <div style="display:grid;grid-template-columns:1fr 1fr 1fr auto;gap:10px;margin-bottom:16px;">
                    <input type="text" id="newCategoryCode" placeholder="코드 (예: engine)" style="padding:8px;border:1px solid var(--border);border-radius:6px;">
                    <input type="text" id="newCategoryNameKo" placeholder="한글명 (예: 엔진)" style="padding:8px;border:1px solid var(--border);border-radius:6px;">
                    <input type="text" id="newCategoryNameEn" placeholder="영문명 (예: Engine)" style="padding:8px;border:1px solid var(--border);border-radius:6px;">
                    <button class="btn btn-primary" onclick="addCategory()">추가</button>
                </div>
                <div id="categoryList" style="display:flex;flex-wrap:wrap;gap:8px;">
                    <div style="color:var(--text-muted);font-size:0.85rem;">로드 중...</div>
                </div>
            </div>

            <div class="content">
                <div id="productList" style="display:grid;grid-template-columns:repeat(auto-fill,minmax(280px,1fr));gap:16px;">
                    <div class="empty-state" style="grid-column:1/-1;padding:60px 20px;">상품 로드 중...</div>
                </div>
            </div>
        </div>

        <!-- ===== 견적문의 탭 ===== -->
        <div id="tabInquiry" class="tab-content">
            <div class="content" style="max-width:960px;margin:0 auto;">
                <h2 style="margin-bottom:16px;">견적문의 관리</h2>
                <table class="doc-table" style="width:100%;border-collapse:collapse;">
                    <thead>
                        <tr>
                            <th style="width:50px">ID</th>
                            <th>제목</th>
                            <th style="width:90px">작성자</th>
                            <th style="width:90px">상태</th>
                            <th style="width:100px">날짜</th>
                            <th style="width:110px">관리</th>
                        </tr>
                    </thead>
                    <tbody id="adminInquiryList"></tbody>
                </table>

                <div id="adminReplyPanel" style="display:none;margin-top:24px;background:#f9fafb;border-radius:12px;padding:24px;">
                    <h3 id="adminReplyTitle" style="margin-bottom:8px;"></h3>
                    <div id="adminReplyMeta" style="font-size:0.88rem;color:#64748b;margin-bottom:12px;"></div>
                    <div id="adminReplyContent" style="background:white;border-radius:8px;padding:16px;margin-bottom:16px;white-space:pre-wrap;line-height:1.7;border:1px solid #e2e8f0;"></div>
                    <div id="adminExistingReplies" style="margin-bottom:16px;"></div>
                    <label style="font-weight:600;display:block;margin-bottom:6px;">답변 작성</label>
                    <textarea id="adminReplyText" rows="5" style="width:100%;padding:10px;border:1px solid #d1d5db;border-radius:8px;font-size:0.95rem;box-sizing:border-box;resize:vertical;"></textarea>
                    <div style="margin-top:12px;display:flex;gap:10px;">
                        <button onclick="submitAdminReply()" style="padding:10px 24px;background:#0a2647;color:white;border:none;border-radius:20px;font-weight:600;cursor:pointer;">답변 등록</button>
                        <button onclick="closeAdminReply()" style="padding:10px 24px;background:transparent;border:1px solid #d1d5db;border-radius:20px;font-weight:600;cursor:pointer;">닫기</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- ===== 문서 관리 탭 ===== -->
        <div id="tabDocs" class="tab-content">
            <div class="content">
                <div class="upload-section">
                    <div class="upload-card" id="uploadConsultant">
                        <input type="file" id="fileInputConsultant" accept=".pdf,.jpg,.jpeg,.png" multiple />
                        <span class="purpose-label purpose-consultant">AI 상담</span>
                        <div class="icon">&#128206;</div>
                        <div class="title">AI 상담 문서 업로드</div>
                        <div class="subtitle">랜딩 페이지 채팅에서 참조</div>
                    </div>
                    <div class="upload-card" id="uploadRag">
                        <input type="file" id="fileInputRag" accept=".pdf,.jpg,.jpeg,.png" multiple />
                        <span class="purpose-label purpose-rag">RAG / 메일</span>
                        <div class="icon">&#128218;</div>
                        <div class="title">RAG / 메일 문서 업로드</div>
                        <div class="subtitle">문서 내 Q&A · 메일 작성에서 참조</div>
                    </div>
                </div>

                <div class="upload-progress" id="uploadProgress">
                    <div class="file-name" id="uploadFileName">업로드 중...</div>
                    <div class="progress-bar"><div class="fill"></div></div>
                </div>

                <div class="docs-section">
                    <h2>업로드된 문서</h2>
                    <div class="docs-table" id="docsTable">
                        <div class="empty-state">
                            <div class="icon">&#128196;</div>
                            <div>아직 업로드된 문서가 없습니다</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ===== 문서 내 Q&A 탭 ===== -->
        <div id="tabRag" class="tab-content">
            <div class="rag-layout">
                <!-- 왼쪽: 대화 목록 -->
                <div class="sidebar-conv">
                    <div class="sidebar-conv-header">
                        <button class="btn btn-accent btn-sm" style="width:100%" onclick="createConversation()">+ 새 대화</button>
                    </div>
                    <div class="conv-list" id="convList">
                        <div class="empty-state" style="padding:32px 12px;font-size:0.82rem">
                            <div style="font-size:1.3rem;margin-bottom:6px;">&#128172;</div>
                            새 대화를 시작하세요
                        </div>
                    </div>
                </div>

                <!-- 가운데: 채팅 -->
                <div class="chat-center">
                    <div class="chat-header-bar" id="chatHeaderBar">
                        <span class="chat-header-title" id="chatHeaderTitle"></span>
                        <div class="chat-header-actions">
                            <button class="btn-icon" id="chatSaveBtn" onclick="toggleSaveConversation()" title="대화 저장">&#11088; 저장</button>
                            <button class="btn-icon" onclick="startRenameFromHeader()" title="이름 변경">&#9998; 이름 변경</button>
                        </div>
                    </div>
                    <div class="chat-messages" id="chatMessages">
                        <div class="chat-welcome" id="chatWelcome">
                            <div class="chat-welcome-icon">&#9875;</div>
                            <h3>문서 내 Q&A</h3>
                            <p>업로드된 기술 문서를 기반으로<br>정확한 답변을 받아보세요</p>
                            <div class="welcome-docs" id="welcomeDocs"></div>
                            <div class="welcome-input-wrap">
                                <div class="welcome-input-box">
                                    <input type="text" id="welcomeInput" placeholder="문서에 대해 질문하세요..." />
                                    <button class="chat-send-btn" id="welcomeSendBtn" onclick="sendRagMessage()">&#10148;</button>
                                </div>
                                <div class="welcome-hint">Enter로 전송 — 대화가 자동 생성됩니다</div>
                            </div>
                        </div>
                    </div>
                    <div class="chat-input-wrap" id="chatInputWrap" style="display:none">
                        <div class="chat-input-box">
                            <input type="text" id="ragInput" placeholder="문서에 대해 질문하세요..." />
                            <button class="chat-send-btn" id="ragSendBtn" onclick="sendRagMessage()">&#10148;</button>
                        </div>
                    </div>
                </div>

                <!-- 오른쪽: 참조 문서 -->
                <div class="sidebar-ref">
                    <div class="sidebar-ref-header">
                        <span class="header-icon">&#128196;</span>
                        참조 문서
                    </div>
                    <div class="ref-doc-list" id="refDocList">
                        <div class="empty-state" style="padding:20px 12px;font-size:0.8rem">문서 로드 중...</div>
                    </div>
                    <div class="ref-resizer" id="refResizer"></div>
                    <div class="ref-chunks-area" id="refChunksPanel">
                        <div class="ref-chunks-title">&#128269; 참조된 문서 내용</div>
                        <div style="font-size:0.76rem;color:var(--text-muted);text-align:center;padding:12px 0;">질문을 입력하면<br>참조 내용이 표시됩니다</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ===== 메일 작성 탭 ===== -->
        <div id="tabMail" class="tab-content">
            <!-- Gmail 연동 바 -->
            <div class="gmail-bar" id="gmailBar">
                <span class="gmail-bar-title">&#128231; Gmail 연동</span>
                <input type="text" id="gmailEmail" placeholder="이메일 주소" />
                <input type="password" id="gmailAppPassword" placeholder="앱 비밀번호" />
                <button class="btn btn-accent btn-sm" onclick="gmailConnect()">연결</button>
                <button class="btn btn-ghost btn-sm" onclick="gmailDisconnect()" id="gmailDisconnectBtn" style="display:none">연결 해제</button>
                <button class="btn btn-primary btn-sm" onclick="gmailFetch()" id="gmailFetchBtn" style="display:none">&#128229; 메일 가져오기</button>
                <div class="gmail-status" id="gmailStatus">
                    <span class="gmail-status-dot disconnected" id="gmailDot"></span>
                    <span id="gmailStatusText">연결 안됨</span>
                </div>
                <div class="gmail-auto-settings" id="gmailAutoSettings" style="display:none">
                    <span>자동 체크:</span>
                    <select id="gmailCheckTime">
                        <option value="07:00">07:00</option>
                        <option value="08:00">08:00</option>
                        <option value="09:00" selected>09:00</option>
                        <option value="10:00">10:00</option>
                        <option value="12:00">12:00</option>
                        <option value="15:00">15:00</option>
                        <option value="18:00">18:00</option>
                    </select>
                    <div class="gmail-toggle" id="gmailAutoToggle" onclick="toggleGmailAuto()"></div>
                    <span id="gmailLastChecked"></span>
                </div>
            </div>
            <div class="mail-layout">
                <!-- 왼쪽: 기능 사이드바 -->
                <div class="mail-left-sidebar" id="mailLeftSidebar">
                    <div class="mail-sidebar-toggle" onclick="toggleMailSidebar()" title="사이드바 고정/해제">☰</div>

                    <!-- 작업 그룹 -->
                    <div class="mail-sidebar-group">
                        <div class="mail-sidebar-group-title">작업</div>
                        <div class="mail-sidebar-item active" onclick="showMailPanel('compose')" id="sidebarCompose" title="메일 작성">
                            <div class="mail-sidebar-item-icon">✉️</div>
                            <div class="mail-sidebar-item-text">메일 작성</div>
                        </div>
                        <div class="mail-sidebar-item" onclick="showMailPanel('inbox')" id="sidebarInbox" title="Gmail 수신함 보기">
                            <div class="mail-sidebar-item-icon">📥</div>
                            <div class="mail-sidebar-item-text">수신함</div>
                        </div>
                    </div>

                    <!-- 참고자료 그룹 -->
                    <div class="mail-sidebar-group">
                        <div class="mail-sidebar-group-title">참고자료</div>
                        <div class="mail-sidebar-item" onclick="showMailPanel('docs')" id="sidebarDocs" title="참조할 문서 선택">
                            <div class="mail-sidebar-item-icon">📁</div>
                            <div class="mail-sidebar-item-text">문서</div>
                        </div>
                        <div class="mail-sidebar-item" onclick="showMailPanel('templates')" id="sidebarTemplates" title="메일 템플릿 관리">
                            <div class="mail-sidebar-item-icon">📝</div>
                            <div class="mail-sidebar-item-text">템플릿</div>
                        </div>
                        <div class="mail-sidebar-item" onclick="showMailPanel('history')" id="sidebarHistory" title="메일 작성 이력">
                            <div class="mail-sidebar-item-icon">🕐</div>
                            <div class="mail-sidebar-item-text">이력</div>
                        </div>
                    </div>

                    <!-- 설정 그룹 -->
                    <div class="mail-sidebar-group">
                        <div class="mail-sidebar-group-title">설정</div>
                        <div class="mail-sidebar-item" onclick="showMailPanel('prompts')" id="sidebarPrompts" title="프롬프트 예시 관리">
                            <div class="mail-sidebar-item-icon">💬</div>
                            <div class="mail-sidebar-item-text">예시</div>
                        </div>
                        <div class="mail-sidebar-item" onclick="showMailPanel('signatures')" id="sidebarSignatures" title="서명 관리">
                            <div class="mail-sidebar-item-icon">✍️</div>
                            <div class="mail-sidebar-item-text">서명</div>
                        </div>
                    </div>
                </div>

                <!-- 중앙: 메인 작업 영역 -->
                <div class="mail-main" style="position:relative;flex:1;">
                    <!-- 수신 메일 입력 -->
                    <div class="mail-incoming">
                        <div class="mail-incoming-header">
                            <h3>📨 수신 메일</h3>
                            <div class="mail-controls">
                                <select id="mailTone">
                                    <option value="formal">격식</option>
                                    <option value="friendly">친근</option>
                                    <option value="concise">간결</option>
                                </select>
                                <button class="btn btn-primary btn-sm" id="mailTranslateIncomingBtn" onclick="translateIncoming()">🇰🇷 번역</button>
                                <button class="btn btn-accent btn-sm" id="mailComposeBtn" onclick="composeMail()">✍️ 답장 생성</button>
                            </div>
                        </div>
                        <textarea id="mailIncoming" placeholder="수신된 견적/문의 메일 내용을 붙여넣으세요...&#10;&#10;예: Dear Young Marine Tech, We would like to request a quotation for the following spare parts..."></textarea>
                        <!-- HTML 메일 프리뷰 (body_html 있을 때만 표시) -->
                        <div id="mailIncomingHtml" style="display:none;background:white;border:1px solid var(--border);border-radius:8px;margin:8px;padding:12px;max-height:400px;overflow:auto;">
                            <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px;padding-bottom:8px;border-bottom:1px solid var(--border-light);">
                                <span style="font-size:0.75rem;color:var(--text-muted);font-weight:500;">&#128279; HTML 메일</span>
                                <button onclick="toggleMailHtmlView()" style="font-size:0.7rem;padding:3px 8px;background:var(--bg-gray);border:1px solid var(--border);border-radius:4px;cursor:pointer;color:var(--text-regular);">텍스트 보기</button>
                            </div>
                            <iframe id="mailHtmlFrame" sandbox="allow-same-origin" style="width:100%;min-height:300px;border:none;border-radius:4px;background:white;"></iframe>
                        </div>
                        <!-- 수신 메일 분할 번역 뷰 (초기 숨김) -->
                        <div class="mail-incoming-split" id="mailIncomingSplit">
                            <div class="incoming-pane">
                                <div class="incoming-pane-header">
                                    <span class="incoming-pane-title">&#128196; 원문 <span class="mail-pane-badge badge-lang" id="incomingSrcLangBadge">EN</span></span>
                                </div>
                                <textarea id="mailIncomingOriginal" placeholder="원문"></textarea>
                            </div>
                            <div class="incoming-pane">
                                <div class="incoming-pane-header">
                                    <span class="incoming-pane-title">&#127472;&#127479; 한국어 번역 <span class="mail-pane-badge badge-ko">KO</span></span>
                                </div>
                                <textarea id="mailIncomingTranslated" readonly placeholder="번역 결과가 여기에 표시됩니다."></textarea>
                            </div>
                        </div>
                        <div class="mail-analysis" id="mailAnalysis">
                            <div class="mail-analysis-label">&#128269; 메일 분석</div>
                            <div id="mailAnalysisText"></div>
                        </div>
                    </div>

                    <!-- 리사이즈 핸들 -->
                    <div class="mail-resize-handle" id="mailResizeHandle"></div>

                    <!-- 분할 편집 영역 -->
                    <div class="mail-editor">
                        <div class="mail-pane">
                            <div class="mail-pane-header">
                                <span class="mail-pane-title">&#9998; 한국어 초안 <span class="mail-pane-badge badge-ko">KO</span></span>
                                <div style="display:flex;gap:6px;align-items:center;">
                                    <select id="mailSignatureSelect" style="padding:4px 8px;border:1px solid var(--border);border-radius:6px;font-size:0.75rem;font-family:inherit">
                                        <option value="">서명 선택...</option>
                                    </select>
                                    <button onclick="insertSignature()" style="padding:4px 8px;background:var(--primary);color:white;border:none;border-radius:6px;font-size:0.7rem;cursor:pointer;" title="서명 삽입">&#10133; 삽입</button>
                                </div>
                            </div>
                            <textarea id="mailKoreanDraft" placeholder="답장 생성 버튼을 클릭하면 한국어 초안이 여기에 표시됩니다.&#10;수정 후 번역 버튼을 눌러주세요."></textarea>
                        </div>
                        <div class="mail-pane">
                            <div class="mail-pane-header">
                                <span class="mail-pane-title">&#127760; 번역본 <span class="mail-pane-badge badge-lang" id="mailTargetLangBadge">EN</span></span>
                                <select id="mailTargetLang" style="padding:4px 8px;border:1px solid var(--border);border-radius:6px;font-size:0.75rem;font-family:inherit">
                                    <option value="en">English</option>
                                    <option value="ja">日本語</option>
                                    <option value="zh">中文</option>
                                    <option value="de">Deutsch</option>
                                    <option value="fr">Français</option>
                                    <option value="es">Español</option>
                                </select>
                            </div>
                            <textarea id="mailTranslated" readonly placeholder="한국어 초안을 번역하면 여기에 표시됩니다."></textarea>
                        </div>
                    </div>

                    <!-- 하단 액션 -->
                    <div class="mail-actions">
                        <div class="mail-actions-left">
                            <button class="btn btn-ghost btn-sm" id="mailRecomposeBtn" onclick="recomposeMail()" disabled>&#128260; 재작성</button>
                            <button class="btn btn-primary btn-sm" id="mailTranslateBtn" onclick="translateMail()" disabled>&#127760; 번역</button>
                            <button class="btn btn-ghost btn-sm" id="mailRetranslateBtn" onclick="translateMail()" disabled>&#128260; 재번역</button>
                        </div>
                        <div class="mail-actions-right">
                            <button class="btn btn-ghost btn-sm" onclick="copyMailDraft('ko')" title="한국어 복사">&#128203; 한국어 복사</button>
                            <button class="btn btn-ghost btn-sm" onclick="copyMailDraft('translated')" title="번역본 복사">&#128203; 번역본 복사</button>
                            <button class="btn btn-primary btn-sm" id="mailSaveBtn" onclick="saveMailComposition()" disabled>&#128190; 저장</button>
                            <button class="btn btn-accent btn-sm" id="mailSendBtn" onclick="sendMailReply()" disabled style="display:none">&#128228; 발송</button>
                        </div>
                    </div>

                    <!-- 로딩 오버레이 -->
                    <div class="mail-loading" id="mailLoading">
                        <div class="mail-loading-spinner"></div>
                        <div class="mail-loading-text" id="mailLoadingText">답장을 생성하고 있습니다...</div>
                    </div>
                </div>

                <!-- 오른쪽: 상세 패널 -->
                <div class="mail-sidebar" id="mailRightPanel">
                    <!-- 패널 헤더 -->
                    <div style="padding:16px;border-bottom:1px solid var(--border);background:var(--bg-gray);display:flex;justify-content:space-between;align-items:center;">
                        <h3 style="font-size:1rem;margin:0;" id="mailPanelTitle">📨 메일 작성</h3>
                        <button onclick="hideMailPanel()" style="background:none;border:none;font-size:1.2rem;cursor:pointer;color:var(--text-muted);" title="닫기">×</button>
                    </div>

                    <!-- 수신함 패널 -->
                    <div id="mailSidePanelInbox" style="flex:1;overflow-y:auto;padding:8px 10px;">
                        <div class="empty-state" style="padding:20px 10px;font-size:0.8rem" id="inboxEmpty">Gmail을 연결하면<br>수신 메일이 표시됩니다</div>
                        <div id="inboxList"></div>
                    </div>

                    <!-- 참조 문서 패널 -->
                    <div id="mailSidePanelDocs" style="flex:1;overflow-y:auto;padding:8px 10px;display:none;">
                        <div class="mail-doc-list" id="mailDocList">
                            <div class="empty-state" style="padding:20px 10px;font-size:0.8rem">문서 로드 중...</div>
                        </div>
                    </div>

                    <!-- 템플릿 패널 -->
                    <div id="mailSidePanelTemplates" style="flex:1;overflow-y:auto;padding:8px 10px;display:none;">
                        <div style="margin-bottom:8px;">
                            <button class="btn btn-primary btn-sm" onclick="showTemplateForm()" style="width:100%">&#10133; 템플릿 추가</button>
                        </div>
                        <div style="margin-bottom:8px;">
                            <select id="templateCategoryFilter" onchange="filterTemplates()" style="width:100%;padding:6px;border:1px solid var(--border);border-radius:6px;font-size:0.8rem;">
                                <option value="">전체 카테고리</option>
                                <option value="general">일반</option>
                                <option value="quotation">견적</option>
                                <option value="inquiry">문의</option>
                                <option value="follow-up">후속</option>
                            </select>
                        </div>
                        <div id="templateForm" style="display:none;background:var(--bg-gray);padding:10px;border-radius:8px;margin-bottom:10px;">
                            <input type="hidden" id="templateId" value="">
                            <div style="margin-bottom:8px;">
                                <label style="font-size:0.75rem;color:var(--text-muted);display:block;margin-bottom:4px;">템플릿 이름</label>
                                <input type="text" id="templateName" style="width:100%;padding:6px;border:1px solid var(--border);border-radius:4px;font-size:0.8rem;" placeholder="예: 견적 요청 답변">
                            </div>
                            <div style="margin-bottom:8px;">
                                <label style="font-size:0.75rem;color:var(--text-muted);display:block;margin-bottom:4px;">카테고리</label>
                                <select id="templateCategory" style="width:100%;padding:6px;border:1px solid var(--border);border-radius:4px;font-size:0.8rem;">
                                    <option value="general">일반</option>
                                    <option value="quotation">견적</option>
                                    <option value="inquiry">문의</option>
                                    <option value="follow-up">후속</option>
                                </select>
                            </div>
                            <div style="margin-bottom:8px;">
                                <label style="font-size:0.75rem;color:var(--text-muted);display:block;margin-bottom:4px;">내용 (변수: {{고객명}}, {{제품명}} 등)</label>
                                <textarea id="templateContent" rows="5" style="width:100%;padding:6px;border:1px solid var(--border);border-radius:4px;font-size:0.8rem;font-family:inherit;resize:vertical;" placeholder="안녕하세요 {{고객명}}님,&#10;{{제품명}} 견적을 보내드립니다..."></textarea>
                            </div>
                            <div style="display:flex;gap:6px;">
                                <button class="btn btn-accent btn-sm" onclick="saveTemplate()" style="flex:1">저장</button>
                                <button class="btn btn-ghost btn-sm" onclick="hideTemplateForm()">취소</button>
                            </div>
                        </div>
                        <div id="templateList">
                            <div class="empty-state" style="padding:20px 10px;font-size:0.8rem">템플릿 로드 중...</div>
                        </div>
                    </div>

                    <!-- 이력 패널 -->
                    <div id="mailSidePanelHistory" style="flex:1;overflow-y:auto;padding:8px 10px;display:none;">
                        <div class="mail-history-list" id="mailHistoryList">
                            <div class="empty-state" style="padding:20px 10px;font-size:0.8rem">저장된 이력이 없습니다</div>
                        </div>
                    </div>

                    <!-- 프롬프트 예시 패널 -->
                    <div id="mailSidePanelPrompts" style="flex:1;overflow-y:auto;padding:8px 10px;display:none;">
                        <div style="margin-bottom:8px;">
                            <button class="btn btn-primary btn-sm" onclick="showPromptExampleForm()" style="width:100%">&#10133; 예시 추가</button>
                        </div>
                        <div id="promptExampleForm" style="display:none;background:var(--bg-gray);padding:10px;border-radius:8px;margin-bottom:10px;">
                            <input type="hidden" id="promptExampleId" value="">
                            <div style="margin-bottom:8px;">
                                <label style="font-size:0.75rem;color:var(--text-muted);display:block;margin-bottom:4px;">수신 메일 예시</label>
                                <textarea id="promptIncomingText" rows="3" style="width:100%;padding:6px;border:1px solid var(--border);border-radius:4px;font-size:0.8rem;font-family:inherit;resize:vertical;" placeholder="예: I need a quotation for..."></textarea>
                            </div>
                            <div style="margin-bottom:8px;">
                                <label style="font-size:0.75rem;color:var(--text-muted);display:block;margin-bottom:4px;">답장 예시</label>
                                <textarea id="promptReplyText" rows="3" style="width:100%;padding:6px;border:1px solid var(--border);border-radius:4px;font-size:0.8rem;font-family:inherit;resize:vertical;" placeholder="예: 견적서를 확인해주세요..."></textarea>
                            </div>
                            <div style="margin-bottom:8px;">
                                <label style="font-size:0.75rem;color:var(--text-muted);display:block;margin-bottom:4px;">정렬 순서</label>
                                <input type="number" id="promptSortOrder" value="0" style="width:100%;padding:6px;border:1px solid var(--border);border-radius:4px;font-size:0.8rem;">
                            </div>
                            <div style="display:flex;gap:6px;">
                                <button class="btn btn-accent btn-sm" onclick="savePromptExample()" style="flex:1">저장</button>
                                <button class="btn btn-ghost btn-sm" onclick="hidePromptExampleForm()">취소</button>
                            </div>
                        </div>
                        <div id="promptExampleList">
                            <div class="empty-state" style="padding:20px 10px;font-size:0.8rem">예시 로드 중...</div>
                        </div>
                    </div>

                    <!-- 서명 패널 -->
                    <div id="mailSidePanelSignatures" style="flex:1;overflow-y:auto;padding:8px 10px;display:none;">
                        <div style="margin-bottom:8px;">
                            <button class="btn btn-primary btn-sm" onclick="showSignatureForm()" style="width:100%">&#10133; 서명 추가</button>
                        </div>
                        <div id="signatureForm" style="display:none;background:var(--bg-gray);padding:10px;border-radius:8px;margin-bottom:10px;">
                            <input type="hidden" id="signatureId" value="">
                            <div style="margin-bottom:8px;">
                                <label style="font-size:0.75rem;color:var(--text-muted);display:block;margin-bottom:4px;">서명 이름</label>
                                <input type="text" id="signatureName" style="width:100%;padding:6px;border:1px solid var(--border);border-radius:4px;font-size:0.8rem;" placeholder="예: 기본 서명, 영문 서명">
                            </div>
                            <div style="margin-bottom:8px;">
                                <label style="font-size:0.75rem;color:var(--text-muted);display:block;margin-bottom:4px;">서명 내용</label>
                                <textarea id="signatureContent" rows="5" style="width:100%;padding:6px;border:1px solid var(--border);border-radius:4px;font-size:0.8rem;font-family:inherit;resize:vertical;" placeholder="예:&#10;Best regards,&#10;홍길동&#10;영마린테크&#10;Tel: 02-1234-5678"></textarea>
                            </div>
                            <div style="margin-bottom:8px;">
                                <label style="display:flex;align-items:center;gap:6px;font-size:0.8rem;cursor:pointer;">
                                    <input type="checkbox" id="signatureIsDefault" style="cursor:pointer;">
                                    <span>기본 서명으로 설정</span>
                                </label>
                            </div>
                            <div style="display:flex;gap:6px;">
                                <button class="btn btn-accent btn-sm" onclick="saveSignature()" style="flex:1">저장</button>
                                <button class="btn btn-ghost btn-sm" onclick="hideSignatureForm()">취소</button>
                            </div>
                        </div>
                        <div id="signatureList">
                            <div class="empty-state" style="padding:20px 10px;font-size:0.8rem">서명 로드 중...</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ===== 시스템 로그 탭 ===== -->
        <div id="tabLogs" class="tab-content">
            <div class="tab-header">
                <h2>&#128221; 시스템 로그</h2>
                <p style="color:var(--text-muted);font-size:0.9rem;margin-top:4px;">메일 작성 이력 및 시스템 활동 로그</p>
            </div>

            <div style="max-width:1200px;margin:0 auto;padding:20px;">
                <div style="background:white;border:1px solid var(--border);border-radius:12px;padding:20px;">
                    <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:16px;">
                        <h3 style="margin:0;font-size:1.1rem;">&#9993; 메일 작성 이력</h3>
                        <button class="btn btn-ghost btn-sm" onclick="loadMailLogs()">&#128260; 새로고침</button>
                    </div>
                    <div id="mailLogsList" style="max-height:600px;overflow-y:auto;">
                        <div class="empty-state" style="padding:40px 20px;">로그 로드 중...</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ===== 홈페이지 관리 탭 ===== -->
        <div id="tabHomepage" class="tab-content">
            <div class="tab-header">
                <h2>&#127968; 홈페이지 관리</h2>
                <p style="color:var(--text-muted);font-size:0.9rem;margin-top:4px;">사이트 로고, 회사 정보, 히어로 섹션 등을 관리합니다.</p>
            </div>

            <div style="max-width:900px;margin:0 auto;padding:20px;">
                <!-- 로고 설정 -->
                <div style="background:white;border:1px solid var(--border);border-radius:12px;padding:20px;margin-bottom:20px;">
                    <h3 style="margin:0 0 16px 0;font-size:1.1rem;display:flex;align-items:center;gap:8px;">
                        <span>&#128444;</span> 로고 이미지
                    </h3>
                    <div style="display:flex;gap:20px;align-items:start;">
                        <div style="flex:1;">
                            <div style="margin-bottom:12px;">
                                <label style="display:block;font-size:0.85rem;color:var(--text-muted);margin-bottom:6px;">현재 로고</label>
                                <div id="currentLogo" style="border:1px solid var(--border);border-radius:8px;padding:20px;text-align:center;background:var(--bg-gray);min-height:120px;display:flex;align-items:center;justify-content:center;">
                                    <span style="color:var(--text-muted);font-size:0.85rem;">로고 로드 중...</span>
                                </div>
                            </div>
                            <div>
                                <label style="display:block;font-size:0.85rem;color:var(--text-muted);margin-bottom:6px;">새 로고 업로드</label>
                                <!-- 드래그앤드롭 영역 -->
                                <div id="logoDropZone" style="border:2px dashed var(--border);border-radius:8px;padding:30px;text-align:center;cursor:pointer;transition:all 0.2s;background:var(--bg-gray);" onclick="document.getElementById('logoFileInput').click()">
                                    <div style="font-size:2rem;margin-bottom:8px;">📁</div>
                                    <div style="font-size:0.85rem;color:var(--text-regular);margin-bottom:4px;">이미지 파일을 드래그하거나 클릭하세요</div>
                                    <div style="font-size:0.75rem;color:var(--text-muted);">PNG, JPG, GIF 지원</div>
                                    <input type="file" id="logoFileInput" accept="image/*" style="display:none;">
                                </div>
                                <div style="margin-top:8px;font-size:0.75rem;color:var(--text-muted);text-align:center;">또는</div>
                                <input type="text" id="logoInput" placeholder="이미지 URL 입력 (https://...)" style="width:100%;padding:10px;border:1px solid var(--border);border-radius:6px;font-size:0.9rem;margin-top:8px;">
                            </div>
                        </div>
                        <div>
                            <button class="btn btn-primary" onclick="saveLogo()">로고 저장</button>
                        </div>
                    </div>
                </div>

                <!-- 회사 정보 -->
                <div style="background:white;border:1px solid var(--border);border-radius:12px;padding:20px;margin-bottom:20px;">
                    <h3 style="margin:0 0 16px 0;font-size:1.1rem;display:flex;align-items:center;gap:8px;">
                        <span>&#128188;</span> 회사 정보
                    </h3>
                    <div style="display:grid;gap:12px;">
                        <div>
                            <label style="display:block;font-size:0.85rem;color:var(--text-muted);margin-bottom:6px;">회사명</label>
                            <input type="text" id="companyName" style="width:100%;padding:10px;border:1px solid var(--border);border-radius:6px;">
                        </div>
                        <div>
                            <label style="display:block;font-size:0.85rem;color:var(--text-muted);margin-bottom:6px;">주소</label>
                            <input type="text" id="companyAddress" style="width:100%;padding:10px;border:1px solid var(--border);border-radius:6px;">
                        </div>
                        <div style="display:grid;grid-template-columns:1fr 1fr;gap:12px;">
                            <div>
                                <label style="display:block;font-size:0.85rem;color:var(--text-muted);margin-bottom:6px;">전화번호</label>
                                <input type="text" id="companyPhone" style="width:100%;padding:10px;border:1px solid var(--border);border-radius:6px;">
                            </div>
                            <div>
                                <label style="display:block;font-size:0.85rem;color:var(--text-muted);margin-bottom:6px;">이메일</label>
                                <input type="text" id="companyEmail" style="width:100%;padding:10px;border:1px solid var(--border);border-radius:6px;">
                            </div>
                        </div>
                        <div style="text-align:right;margin-top:8px;">
                            <button class="btn btn-primary" onclick="saveCompanyInfo()">회사 정보 저장</button>
                        </div>
                    </div>
                </div>

                <!-- 히어로 섹션 -->
                <div style="background:white;border:1px solid var(--border);border-radius:12px;padding:20px;margin-bottom:20px;">
                    <h3 style="margin:0 0 16px 0;font-size:1.1rem;display:flex;align-items:center;gap:8px;">
                        <span>&#127775;</span> 히어로 섹션
                    </h3>
                    <div style="display:grid;gap:12px;">
                        <div>
                            <label style="display:block;font-size:0.85rem;color:var(--text-muted);margin-bottom:6px;">메인 제목</label>
                            <input type="text" id="heroTitle" style="width:100%;padding:10px;border:1px solid var(--border);border-radius:6px;" placeholder="예: 해양 엔진 부품 전문">
                        </div>
                        <div>
                            <label style="display:block;font-size:0.85rem;color:var(--text-muted);margin-bottom:6px;">부제목</label>
                            <textarea id="heroSubtitle" rows="2" style="width:100%;padding:10px;border:1px solid var(--border);border-radius:6px;resize:vertical;" placeholder="예: 신뢰할 수 있는 해양 엔진 부품 공급업체"></textarea>
                        </div>
                        <div style="text-align:right;margin-top:8px;">
                            <button class="btn btn-primary" onclick="saveHeroSection()">히어로 섹션 저장</button>
                        </div>
                    </div>
                </div>

                <!-- 기타 설정 -->
                <div style="background:white;border:1px solid var(--border);border-radius:12px;padding:20px;">
                    <h3 style="margin:0 0 16px 0;font-size:1.1rem;display:flex;align-items:center;gap:8px;">
                        <span>&#9881;</span> 기타 설정
                    </h3>
                    <div style="display:grid;gap:12px;">
                        <div>
                            <label style="display:block;font-size:0.85rem;color:var(--text-muted);margin-bottom:6px;">푸터 저작권 문구</label>
                            <input type="text" id="footerCopyright" style="width:100%;padding:10px;border:1px solid var(--border);border-radius:6px;" placeholder="© 2024 영마린테크. All rights reserved.">
                        </div>
                        <div style="text-align:right;margin-top:8px;">
                            <button class="btn btn-primary" onclick="saveOtherSettings()">설정 저장</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- ===== 문서 상세 모달 ===== -->
    <div class="modal-overlay" id="docModal">
        <div class="modal">
            <button class="close-btn" onclick="closeModal()">&times;</button>
            <h3 id="modalTitle">문서 상세</h3>
            <div id="modalContent"></div>
        </div>
    </div>

    <!-- ===== 상품 추가/수정 모달 ===== -->
    <div class="modal-overlay" id="productModal" style="display:none;">
        <div class="modal" style="max-width:700px;max-height:90vh;overflow-y:auto;">
            <button class="close-btn" onclick="closeProductModal()">&times;</button>
            <h3 id="productModalTitle">상품 추가</h3>
            <div style="margin-top:20px;">
                <input type="hidden" id="productId">

                <div style="margin-bottom:16px;">
                    <label style="display:block;font-size:0.85rem;font-weight:500;margin-bottom:6px;color:var(--text-regular);">상품 이미지</label>
                    <div id="imageDropZone" style="border:2px dashed var(--border);border-radius:8px;padding:20px;text-align:center;cursor:pointer;background:var(--bg-gray);transition:all 0.2s;" onclick="document.getElementById('imageFileInput').click()">
                        <div id="imagePreview" style="display:none;margin-bottom:10px;">
                            <img id="previewImg" src="" style="max-width:100%;max-height:200px;border-radius:6px;">
                        </div>
                        <div id="dropZonePlaceholder">
                            <div style="font-size:2rem;margin-bottom:8px;">📷</div>
                            <div style="font-size:0.85rem;color:var(--text-muted);margin-bottom:4px;">이미지를 드래그하거나 클릭하여 업로드</div>
                            <div style="font-size:0.75rem;color:var(--text-light);">JPG, PNG, GIF (최대 5MB)</div>
                        </div>
                    </div>
                    <input type="file" id="imageFileInput" accept="image/*" style="display:none;" onchange="handleImageUpload(event)">
                    <input type="hidden" id="productImage">
                </div>

                <div style="display:grid;grid-template-columns:1fr 1fr;gap:16px;margin-bottom:16px;">
                    <div>
                        <label style="display:block;font-size:0.85rem;font-weight:500;margin-bottom:6px;color:var(--text-regular);">부품번호</label>
                        <input type="text" id="productPartNo" style="width:100%;padding:10px;border:1px solid var(--border);border-radius:6px;" placeholder="예: ABC-1234">
                    </div>
                    <div>
                        <label style="display:block;font-size:0.85rem;font-weight:500;margin-bottom:6px;color:var(--text-regular);">가격</label>
                        <input type="text" id="productPrice" style="width:100%;padding:10px;border:1px solid var(--border);border-radius:6px;" placeholder="예: ₩150,000">
                    </div>
                </div>

                <div style="display:grid;grid-template-columns:1fr 1fr;gap:16px;margin-bottom:16px;">
                    <div>
                        <label style="display:block;font-size:0.85rem;font-weight:500;margin-bottom:6px;color:var(--text-regular);">브랜드</label>
                        <input type="text" id="productBrand" style="width:100%;padding:10px;border:1px solid var(--border);border-radius:6px;" placeholder="예: Volvo Penta">
                    </div>
                    <div>
                        <label style="display:block;font-size:0.85rem;font-weight:500;margin-bottom:6px;color:var(--text-regular);">카테고리</label>
                        <select id="productCategory" style="width:100%;padding:10px;border:1px solid var(--border);border-radius:6px;">
                            <!-- 동적으로 로드됨 -->
                        </select>
                    </div>
                </div>

                <div style="margin-bottom:16px;">
                    <label style="display:block;font-size:0.85rem;font-weight:500;margin-bottom:6px;color:var(--text-regular);">상품명 (한국어)</label>
                    <input type="text" id="productNameKo" style="width:100%;padding:10px;border:1px solid var(--border);border-radius:6px;" placeholder="예: 볼보펜타 엔진 오일 필터">
                </div>

                <div style="margin-bottom:16px;">
                    <label style="display:block;font-size:0.85rem;font-weight:500;margin-bottom:6px;color:var(--text-regular);">상품명 (영어)</label>
                    <input type="text" id="productNameEn" style="width:100%;padding:10px;border:1px solid var(--border);border-radius:6px;" placeholder="예: Volvo Penta Engine Oil Filter">
                </div>

                <div style="margin-bottom:16px;">
                    <label style="display:block;font-size:0.85rem;font-weight:500;margin-bottom:6px;color:var(--text-regular);">설명 (한국어)</label>
                    <textarea id="productDescKo" rows="3" style="width:100%;padding:10px;border:1px solid var(--border);border-radius:6px;resize:vertical;" placeholder="상품 설명을 입력하세요"></textarea>
                </div>

                <div style="margin-bottom:20px;">
                    <label style="display:block;font-size:0.85rem;font-weight:500;margin-bottom:6px;color:var(--text-regular);">설명 (영어)</label>
                    <textarea id="productDescEn" rows="3" style="width:100%;padding:10px;border:1px solid var(--border);border-radius:6px;resize:vertical;" placeholder="Product description"></textarea>
                </div>

                <!-- 추가 정보 섹션 -->
                <div style="background:var(--bg-gray);padding:16px;border-radius:8px;margin-bottom:20px;">
                    <h4 style="font-size:0.95rem;font-weight:600;margin-bottom:12px;color:var(--text-dark);">추가 정보</h4>

                    <!-- 상세 정보 -->
                    <div style="margin-bottom:16px;">
                        <label style="display:block;font-size:0.85rem;font-weight:500;margin-bottom:8px;color:var(--text-regular);">상세 정보</label>
                        <div id="detailInfoList" style="display:flex;flex-direction:column;gap:8px;"></div>
                        <button type="button" onclick="addDetailInfoRow()" style="margin-top:8px;padding:6px 12px;background:white;border:1px solid var(--border);border-radius:6px;cursor:pointer;font-size:0.85rem;color:var(--text-regular);">+ 항목 추가</button>
                    </div>

                    <!-- 스펙 -->
                    <div style="margin-bottom:16px;">
                        <label style="display:block;font-size:0.85rem;font-weight:500;margin-bottom:8px;color:var(--text-regular);">스펙</label>
                        <div id="specsList" style="display:flex;flex-direction:column;gap:8px;"></div>
                        <button type="button" onclick="addSpecRow()" style="margin-top:8px;padding:6px 12px;background:white;border:1px solid var(--border);border-radius:6px;cursor:pointer;font-size:0.85rem;color:var(--text-regular);">+ 항목 추가</button>
                    </div>

                    <!-- 호환 정보 -->
                    <div style="margin-bottom:0;">
                        <label style="display:block;font-size:0.85rem;font-weight:500;margin-bottom:8px;color:var(--text-regular);">호환 정보</label>
                        <div id="compatibilityList" style="display:flex;flex-direction:column;gap:8px;"></div>
                        <button type="button" onclick="addCompatibilityRow()" style="margin-top:8px;padding:6px 12px;background:white;border:1px solid var(--border);border-radius:6px;cursor:pointer;font-size:0.85rem;color:var(--text-regular);">+ 항목 추가</button>
                    </div>
                </div>

                <div style="display:flex;gap:10px;justify-content:space-between;">
                    <button class="btn btn-ghost" onclick="deleteProductConfirm()" id="productDeleteBtn" style="background:var(--error);color:white;display:none;">🗑️ 삭제</button>
                    <div style="display:flex;gap:10px;">
                        <button class="btn btn-ghost" onclick="closeProductModal()">취소</button>
                        <button class="btn btn-primary" onclick="saveProduct()">저장</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- ===== 참조 문서 팝업 ===== -->
    <div class="ref-popup-overlay" id="refPopup">
        <div class="ref-popup">
            <div class="ref-popup-header">
                <div class="popup-icon">&#128196;</div>
                <div class="popup-info">
                    <div class="popup-filename" id="refPopupFilename"></div>
                    <div class="popup-score" id="refPopupScore"></div>
                </div>
                <button class="ref-popup-close" onclick="closeRefPopup()">&times;</button>
            </div>
            <div class="ref-popup-body" id="refPopupBody"></div>
        </div>
    </div>


    <!-- Admin JavaScript Modules -->
    <script src="js/api.js"></script>
    <script src="js/auth.js"></script>
    <script src="js/dashboard.js"></script>
    <script src="js/docs.js"></script>
    <script src="js/rag.js"></script>
    <script src="js/inquiry.js"></script>
    <script src="js/products.js"></script>
    <script src="js/mail.js"></script>
    <script src="js/settings.js"></script>
    <script src="js/logs.js"></script>
    <script src="js/init.js"></script> <!-- MUST BE LAST -->
</body>
</html>
